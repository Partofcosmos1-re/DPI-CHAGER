<!-- Replace `your-backend-url` with your actual Render backend URL -->
<script>
  const chatMessages = document.getElementById("chat-messages");
  const messageInput = document.getElementById("message-input");
  const sendButton = document.getElementById("send-button");
  const typingIndicator = document.getElementById("typing-indicator");

  async function callGeminiAPI(prompt) {
    const apiUrl = "https://gemini-backened.onrender.com/api/gemini";

    try {
      const response = await fetch(apiUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });

      if (!response.ok) throw new Error(`API error: ${response.status}`);

      const data = await response.json();
      return (
        data?.candidates?.[0]?.content?.parts?.[0]?.text ||
        "No response received from Gemini API."
      );
    } catch (error) {
      console.error("API Error:", error);
      return "⚠️ Server error. Please try again later.";
    }
  }

  function addMessage(text, isUser) {
    const div = document.createElement("div");
    div.classList.add("message", isUser ? "user-message" : "ai-message");
    div.textContent = text;
    chatMessages.appendChild(div);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  async function sendMessage() {
    const message = messageInput.value.trim();
    if (!message) return;

    addMessage(message, true);
    messageInput.value = "";
    typingIndicator.style.display = "block";

    const reply = await callGeminiAPI(message);
    typingIndicator.style.display = "none";
    addMessage(reply, false);
  }

  sendButton.addEventListener("click", sendMessage);
  messageInput.addEventListener("keypress", (e) => {
    if (e.key === "Enter") sendMessage();
  });

  document.querySelectorAll(".quick-action").forEach((btn) => {
    btn.addEventListener("click", function () {
      messageInput.value = this.textContent;
      sendButton.click();
    });
  });
</script>
